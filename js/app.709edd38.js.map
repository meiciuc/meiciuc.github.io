{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/game/sounds/asteroid.mp3","webpack:///./src/vue/Game.vue?c191","webpack:///./src/game/sounds/asteroid.ogg","webpack:///./src/game/sounds/ship.ogg","webpack:///./src/game/sounds/shoot.ogg","webpack:///./src/game/sounds/shoot.mp3","webpack:///./src/App.vue?5ca2","webpack:///./src/vue/Game.vue?455d","webpack:///./src/game/components/Animation.ts","webpack:///./src/game/components/Asteroid.ts","webpack:///./src/game/components/Audio.ts","webpack:///./src/game/components/Bullet.ts","webpack:///./src/game/components/Collision.ts","webpack:///./src/game/components/DeathThroes.ts","webpack:///./src/game/components/Display.ts","webpack:///./src/game/components/GameState.ts","webpack:///./src/game/components/Gun.ts","webpack:///./src/game/components/GunControls.ts","webpack:///./src/game/components/Motion.ts","webpack:///./src/game/components/MotionControls.ts","webpack:///./src/game/components/Position.ts","webpack:///./src/game/components/Spaceship.ts","webpack:///./src/game/components/CameraShake.ts","webpack:///./src/game/graphics/Dot.ts","webpack:///./src/game/graphics/AsteroidDeathView.ts","webpack:///./src/game/graphics/AsteroidView.ts","webpack:///./src/game/graphics/BulletView.ts","webpack:///./src/game/graphics/SpaceshipDeathView.ts","webpack:///./src/game/graphics/SpaceshipView.ts","webpack:///./src/game/graphics/DebugCrossView.ts","webpack:///./src/game/Keyboard.ts","webpack:///./src/game/EntityCreator.ts","webpack:///./src/game/GameConfig.ts","webpack:///./src/game/sounds/index.ts","webpack:///./src/game/KeyPoll.ts","webpack:///./src/game/nodes.ts","webpack:///./src/game/systems/AnimationSystem.ts","webpack:///./src/game/systems/AudioSystem.ts","webpack:///./src/game/systems/CollisionSystem.ts","webpack:///./src/game/systems/DeathThroesSystem.ts","webpack:///./src/game/systems/GameManager.ts","webpack:///./src/game/systems/GunControlSystem.ts","webpack:///./src/vuex/index.ts","webpack:///./src/game/systems/SystemPriorities.ts","webpack:///./src/vuex/storeGameModule.ts","webpack:///./src/game/systems/HudSystem.ts","webpack:///./src/game/systems/MotionControlSystem.ts","webpack:///./src/game/systems/MovementSystem.ts","webpack:///./src/vuex/storeDevelopingModule.ts","webpack:///./src/game/systems/RenderSystem.ts","webpack:///./src/game/TouchPoll.ts","webpack:///./src/game/Asteroids.ts","webpack:///./src/vue/Game.vue","webpack:///./src/vue/Game.vue?2301","webpack:///./src/vue/Game.vue?db89","webpack:///./src/App.vue","webpack:///./src/App.vue?c9fc","webpack:///./src/App.vue?665f","webpack:///./src/vk/VKBridge.ts","webpack:///./src/main.ts","webpack:///./src/game/sounds/ship.mp3"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","staticRenderFns","on","handleClick","_v","_s","$store","state","storeGameModule","level","score","lives","shots","hits","precision","storeDevelopingModule","deviceSize","displayRatio","scale","sceneSize","_m","_e","ref","animation","fsm","toPlay","sound","radius","countdown","displayObject","GameState","WAIT_FOR_START","PLAY","FINISH","gameState","PAUSE","offsetFromParentX","offsetFromParentY","minimumShotInterval","bulletLifetime","shooting","timeSinceLastShot","trigger","velocityX","velocityY","angularVelocity","damping","left","right","accelerate","accelerationRate","rotationRate","x","y","rotation","magnitude","time","startX","startY","startAngle","tiltAngle","randomInt","min","max","Math","floor","random","upAndDownShake","sprite","maxDistance","angle","PI","distance","speed","cos","sin","beginFill","drawCircle","endFill","setTransform","dots","len","AsteroidDeathView","numDots","dot","addChild","alpha","moveTo","posX","posY","lineTo","shape1","shape2","vel1x","vel1y","vel2x","vel2y","rot1","rot2","size","text","color","thickness","cross","drawRect","textStyle","fontFamily","fontSize","fill","label","width","height","SPACE","LEFT","RIGHT","UP","entitiesNames","GAME","CAMERA","engine","config","entity","removeEntity","container","add","addEntity","gameEntity","asteroid","createState","withInstance","deathView","changeState","spaceship","motion","gun","parentPosition","bullet","camera","getEntityByName","DEFAULT_LIVES_COUNT","DEFAULT_SCREEN_SIZE_AREA","DEFAULT_ASTEROIDS_MIN_COUNT","DEFAULT_ASTEROID_MAX_SIZE","DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_ASTEROID","DEFAULT_CAMERA_SHAKE_TIME_FOR_ASTEROID","DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_SPACESHIP","DEFAULT_CAMERA_SHAKE_TIME_FOR_SPACESHIP","SCALE_SCREEN_TO_DEFAULT_SCREEN_SIZE_AREA","Sounds","WORD_SIZE","keys","Int32Array","keyDownHandler","event","keyCode","index","keyUpHandler","addEventListener","isDown","AnimationNode","AsteroidCollisionNode","position","collision","audio","AudioNode","BulletCollisionNode","DeathThroesNode","death","GameNode","GunControlNode","control","MotionControlNode","MovementNode","RenderNode","display","SpaceshipCollisionNode","SpaceshipNode","shake","node","animate","sounds","mp3","a","ogg","shoot","ship","audioTypeDetect","document","createElement","canPlayMp3","canPlayType","canPlayOgg","type","loadAudioDB","audioContext","audioDB","Map","loadSound","url","fetch","response","arrayBuffer","decodeAudioData","audioBuffer","set","Promise","all","map","creator","games","spaceships","asteroids","bullets","getNodeList","maxSize","minSize","oneSix","head","next","hypot","destroyEntity","createAsteroid","play","cameraShake","currentGameState","gameNode","empty","positionX","positionY","deltaRadius","clearToAddSpaceship","createSpaceship","setForFinish","asteroidCount","minDistance","keyPoll","touchPoll","guns","game","click","createUserBullet","use","SystemPriorities","namespaced","mutations","reset","setState","setScore","setLives","setLevel","setHits","setShots","getters","storeState","setForStart","update","top","deltaBounds","transfer","xDamp","abs","yDamp","setDiplayRatio","setScale","setDeviceSize","setSceneSize","diplayRatio","options","emitStageEvents","entityCreator","gameConfig","resized","nodes","addToDisplay","stage","emit","handleWindowResize","e","removeFromDisplay","removeChild","app","backgroundColor","renderer","view","registerCameraContainer","resize","appendChild","nodeAdded","nodeRemoved","render","rect","getBoundingClientRect","rectArea","style","innerWidth","innerHeight","devicePixelRatio","remove","mouseDown","mouseDownX","mouseDownY","mouseDownTimestamp","mouseDownRadius","mouseMoveX","mouseMoveY","clickTimeout","mouseLeft","mouseRight","mouseTop","mouseBottom","handleTouchStart","console","log","touches","target","clientX","clientY","Date","now","handleTouchEnd","handleTouchMove","resetDirections","getDistance","handleMouseDown","handleMouseUp","handleMouseMove","body","x1","y1","x2","y2","b","sqrt","clientWidth","clientHeight","tickProvider","AudioContext","delta","start","addSystem","preUpdate","move","resolveCollisions","createGame","setTimeout","$refs","components","component","Game","viewportWidth","setupBridge","setupVK","then","setupIFrame","catch","error","viewport_width","viewport_height","vkScrollPos","vkHeight","vkOffset","resolve","reject","unsubscribe","vkBridge","subscribe","handleBridgeSubscribe","send","VK","init","addCallback","handleOnScrollTop","callMethod","productionTip","store","h","$mount"],"mappings":"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","file":"js/app.709edd38.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = __webpack_public_path__ + \"media/asteroid.700707dc.mp3\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=style&index=0&id=783a7232&lang=stylus&scoped=true&\"","module.exports = __webpack_public_path__ + \"media/asteroid.960a0b4d.ogg\";","module.exports = __webpack_public_path__ + \"media/ship.606800c8.ogg\";","module.exports = __webpack_public_path__ + \"media/shoot.164324a9.ogg\";","module.exports = __webpack_public_path__ + \"media/shoot.ecff5374.mp3\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrap_container\",attrs:{\"id\":\"app\"}},[_c('game',{staticClass:\"wrap_container\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"click\":_vm.handleClick}},[_c('div',{staticClass:\"options wrap_container\"},[_c('ul',{staticClass:\"results\"},[_c('li',{staticClass:\"subtitle has-text-white game-score\"},[_vm._v(\"LEVEL: \"+_vm._s(_vm.$store.state.storeGameModule.level))]),_c('li',{staticClass:\"subtitle has-text-white game-score\"},[_vm._v(\"SCORE: \"+_vm._s(_vm.$store.state.storeGameModule.score))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"LIVES: \"+_vm._s(_vm.$store.state.storeGameModule.lives))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"shots: \"+_vm._s(_vm.$store.state.storeGameModule.shots))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"hits: \"+_vm._s(_vm.$store.state.storeGameModule.hits))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"precision: \"+_vm._s(_vm.precision))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"---------------\")]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"deviceSize: \"+_vm._s(_vm.$store.state.storeDevelopingModule.deviceSize))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"displayRatio: \"+_vm._s(_vm.$store.state.storeDevelopingModule.displayRatio))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"scale: \"+_vm._s(_vm.$store.state.storeDevelopingModule.scale))]),_c('li',{staticClass:\"subtitle has-text-white game-lives\"},[_vm._v(\"sceneSize: \"+_vm._s(_vm.$store.state.storeDevelopingModule.sceneSize))])]),(_vm.start)?_c('div',{staticClass:\"center\"},[_vm._m(0)]):_vm._e(),(_vm.finish)?_c('div',{staticClass:\"center\"},[_vm._m(1)]):_vm._e()]),_c('div',{ref:\"game\",staticClass:\"game wrap_container\"})])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"ASTEROIDS\")]),_c('h2',[_vm._v(\"Click to start\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"GAME OVER\")]),_c('h2',[_vm._v(\"Click to start\")])])}]\n\nexport { render, staticRenderFns }","import { Animatable } from '../graphics';\r\n\r\nexport class Animation {\r\n  public animation:Animatable;\r\n\r\n  public constructor(animation:Animatable) {\r\n    this.animation = animation;\r\n  }\r\n}\r\n","import { EntityStateMachine } from '@ash.ts/ash';\r\n\r\nexport class Asteroid {\r\n  public fsm:EntityStateMachine;\r\n\r\n  public constructor(fsm:EntityStateMachine) {\r\n    this.fsm = fsm;\r\n  }\r\n}\r\n","import { Sounds } from '../sounds';\r\n\r\nexport class Audio {\r\n  public toPlay:Sounds[] = [];\r\n\r\n  public play(sound:Sounds):void {\r\n    this.toPlay.push(sound);\r\n  }\r\n}\r\n","export class Bullet {\r\n}\r\n","export class Collision {\r\n  public radius:number;\r\n\r\n  public constructor(radius = 0) {\r\n    this.radius = radius;\r\n  }\r\n}\r\n","export class DeathThroes {\r\n  public countdown:number;\r\n\r\n  public constructor(countdown:number) {\r\n    this.countdown = countdown;\r\n  }\r\n}\r\n","import { DisplayObject } from 'pixi.js';\r\n\r\nexport class Display {\r\n  public displayObject:DisplayObject;\r\n\r\n  public constructor(displayObject:DisplayObject) {\r\n    this.displayObject = displayObject;\r\n  }\r\n}\r\n","export class GameState {\r\n\r\n    public static WAIT_FOR_START = 'wait';\r\n    public static PLAY = 'play';\r\n    public static PAUSE = 'pause';\r\n    public static FINISH = 'finish';\r\n\r\n    public state = GameState.WAIT_FOR_START;\r\n\r\n    public lives = 0;\r\n    public level = 0;\r\n    public hits = 0;\r\n    public shots = 0;\r\n\r\n    public setForStart(): void {\r\n        this.lives = 3;\r\n        this.level = 0;\r\n        this.hits = 0;\r\n        this.shots = 0;\r\n        this.state = GameState.PLAY;\r\n    }\r\n\r\n    public setForFinish(): void {\r\n        this.state = GameState.FINISH;\r\n    }\r\n\r\n    public update(gameState: GameState): void {\r\n        this.lives = gameState.lives;\r\n        this.level = gameState.level;\r\n        this.hits = gameState.hits;\r\n        this.shots = gameState.shots;\r\n        this.state = gameState.state;\r\n    }\r\n}\r\n","export class Gun {\r\n  public shooting = false;\r\n\r\n  public timeSinceLastShot = 0;\r\n\r\n  public offsetFromParentX:number;\r\n\r\n  public offsetFromParentY:number;\r\n\r\n  public minimumShotInterval:number;\r\n\r\n  public bulletLifetime:number;\r\n\r\n  public constructor(\r\n    offsetFromParentX:number,\r\n    offsetFromParentY:number,\r\n    minimumShotInterval = 0,\r\n    bulletLifetime = 0,\r\n  ) {\r\n    this.offsetFromParentX = offsetFromParentX;\r\n    this.offsetFromParentY = offsetFromParentY;\r\n    this.minimumShotInterval = minimumShotInterval;\r\n    this.bulletLifetime = bulletLifetime;\r\n  }\r\n}\r\n","export class GunControls {\r\n  public trigger:number;\r\n\r\n  public constructor(trigger = 0) {\r\n    this.trigger = trigger;\r\n  }\r\n}\r\n","export class Motion {\r\n  public velocityX:number;\r\n\r\n  public velocityY:number;\r\n\r\n  public angularVelocity:number;\r\n\r\n  public damping:number;\r\n\r\n  public constructor(\r\n    velocityX:number,\r\n    velocityY:number,\r\n    angularVelocity = 0,\r\n    damping = 0,\r\n  ) {\r\n    this.velocityX = velocityX;\r\n    this.velocityY = velocityY;\r\n    this.angularVelocity = angularVelocity;\r\n    this.damping = damping;\r\n  }\r\n}\r\n","export class MotionControls {\r\n  public left:number;\r\n\r\n  public right:number;\r\n\r\n  public accelerate:number;\r\n\r\n  public accelerationRate:number;\r\n\r\n  public rotationRate:number;\r\n\r\n  public constructor(\r\n    left = 0,\r\n    right = 0,\r\n    accelerate = 0,\r\n    accelerationRate = 0,\r\n    rotationRate = 0,\r\n  ) {\r\n    this.left = left;\r\n    this.right = right;\r\n    this.accelerate = accelerate;\r\n    this.accelerationRate = accelerationRate;\r\n    this.rotationRate = rotationRate;\r\n  }\r\n}\r\n","export class Position {\r\n  public x:number;\r\n\r\n  public y:number;\r\n\r\n  public rotation:number;\r\n\r\n  public constructor(x:number, y:number, rotation = 0) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.rotation = rotation;\r\n  }\r\n}\r\n","import { EntityStateMachine } from '@ash.ts/ash';\r\n\r\nexport class Spaceship {\r\n  public fsm:EntityStateMachine;\r\n\r\n  public constructor(fsm:EntityStateMachine) {\r\n    this.fsm = fsm;\r\n  }\r\n}\r\n","import { DisplayObject } from \"@pixi/display\";\r\nimport { Animatable } from '../graphics/Animatable';\r\n\r\nexport class CameraShake implements Animatable {\r\n    public readonly displayObject: DisplayObject;\r\n\r\n    startX = 0\r\n    startY = 0;\r\n    startAngle = 0;\r\n\r\n    magnitude = 16;\r\n    tiltAngle = 1;\r\n\r\n    constructor(displayObject: DisplayObject, magnitude = 16, private time = 1) {\r\n        this.displayObject = displayObject;\r\n        this.magnitude = magnitude;\r\n\r\n        this.startX = displayObject.x;\r\n        this.startY = displayObject.y;\r\n        this.startAngle = displayObject.rotation;\r\n    }\r\n\r\n    animate(time: number): void {\r\n        this.time -= time;\r\n        this.upAndDownShake();\r\n        // this.angularShake();\r\n    }\r\n\r\n    upAndDownShake(): void {\r\n        const sprite: DisplayObject = this.displayObject;\r\n        if (this.time >= 0) {\r\n            sprite.x = this.startX;\r\n            sprite.y = this.startY;\r\n            \r\n            const magnitude = this.magnitude * this.time;\r\n\r\n            sprite.x += this.randomInt(-magnitude, magnitude);\r\n            sprite.y += this.randomInt(-magnitude, magnitude);\r\n        } else {\r\n            sprite.x = this.startX;\r\n            sprite.y = this.startY;\r\n        }\r\n    }\r\n\r\n    angularShake() {\r\n        const sprite: DisplayObject = this.displayObject;\r\n        if (this.time >= 0) {\r\n            const magnitude = this.magnitude * this.time;\r\n\r\n            sprite.rotation = this.startAngle + magnitude * this.tiltAngle / 100;\r\n            this.tiltAngle *= -1;\r\n        } else {\r\n            sprite.rotation = this.startAngle;\r\n        }\r\n    }\r\n\r\n\r\nrandomInt = (min: number, max: number) => {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n}","import { Graphics } from 'pixi.js';\r\n\r\nexport class Dot extends Graphics {\r\n  public velocityX:number;\r\n\r\n  public velocityY:number;\r\n\r\n  public constructor(maxDistance:number) {\r\n    super();\r\n\r\n    const angle:number = Math.random() * 2 * Math.PI;\r\n    const distance:number = Math.random() * maxDistance;\r\n    const speed:number = Math.random() * 10 + 10;\r\n    this.velocityX = Math.cos(angle) * speed;\r\n    this.velocityY = Math.sin(angle) * speed;\r\n\r\n    this.beginFill(0xffffff)\r\n      .drawCircle(0, 0, 1)\r\n      .endFill()\r\n      .setTransform(\r\n        Math.cos(angle) * distance,\r\n        Math.sin(angle) * distance,\r\n      );\r\n  }\r\n}\r\n","import { Container } from 'pixi.js';\r\nimport { Animatable } from './Animatable';\r\nimport { Dot } from './Dot';\r\n\r\nexport class AsteroidDeathView extends Container implements Animatable {\r\n    private static numDots = 8;\r\n\r\n    private dots: Dot[] = [];\r\n\r\n    public constructor(radius: number) {\r\n        super();\r\n        const len = AsteroidDeathView.numDots;\r\n        for (let i = 0; i < len; i += 1) {\r\n            const dot: Dot = new Dot(radius);\r\n            this.addChild(dot);\r\n            this.dots.push(dot);\r\n        }\r\n    }\r\n\r\n    public animate(time: number): void {\r\n        for (const dot of this.dots) {\r\n            dot.setTransform(\r\n                dot.x + dot.velocityX * time,\r\n                dot.y + dot.velocityY * time,\r\n            );\r\n            dot.alpha -= time / 2;\r\n        }\r\n    }\r\n}\r\n","import { Graphics } from 'pixi.js';\r\n\r\nexport class AsteroidView extends Graphics {\r\n  public constructor(radius:number) {\r\n    super();\r\n\r\n    this.moveTo(radius, 0).beginFill(0xffffff);\r\n    let angle = 0;\r\n    while (angle < Math.PI * 2) {\r\n      const length:number = (0.75 + Math.random() * 0.25) * radius;\r\n      const posX:number = Math.cos(angle) * length;\r\n      const posY:number = Math.sin(angle) * length;\r\n      this.lineTo(posX, posY);\r\n      angle += Math.random() * 0.5;\r\n    }\r\n    this.lineTo(radius, 0).endFill();\r\n  }\r\n}\r\n","import { Graphics } from 'pixi.js';\r\n\r\nexport class BulletView extends Graphics {\r\n  public constructor() {\r\n    super();\r\n\r\n    this.beginFill(0xffffff).drawCircle(0, 0, 2.5).endFill();\r\n  }\r\n}\r\n","import { Container, Graphics } from 'pixi.js';\r\n\r\nimport { Animatable } from './Animatable';\r\n\r\nexport class SpaceshipDeathView extends Container implements Animatable {\r\n  private readonly shape1:Graphics;\r\n\r\n  private readonly shape2:Graphics;\r\n\r\n  private readonly vel1x:number;\r\n\r\n  private readonly vel1y:number;\r\n\r\n  private readonly vel2x:number;\r\n\r\n  private readonly vel2y:number;\r\n\r\n  private readonly rot1:number;\r\n\r\n  private readonly rot2:number;\r\n\r\n  public constructor() {\r\n    super();\r\n\r\n    this.shape1 = new Graphics();\r\n    this.shape1.moveTo(10, 0).beginFill(0xffffff).lineTo(-7, 7).lineTo(-4, 0)\r\n      .lineTo(10, 0)\r\n      .endFill();\r\n    this.addChild(this.shape1);\r\n\r\n    this.shape2 = new Graphics();\r\n    this.shape2.moveTo(10, 0).beginFill(0xffffff).lineTo(-7, -7).lineTo(-4, 0)\r\n      .lineTo(10, 0)\r\n      .endFill();\r\n    this.addChild(this.shape2);\r\n\r\n    this.vel1x = Math.random() * 10 - 5;\r\n    this.vel1y = Math.random() * 10 + 10;\r\n    this.vel2x = Math.random() * 10 - 5;\r\n    this.vel2y = Math.random() * -10 - 10;\r\n    this.rot1 = Math.random() * 3 - 1.5;\r\n    this.rot2 = Math.random() * 3 - 1.5;\r\n  }\r\n\r\n  public animate(time:number):void {\r\n    const { shape1, shape2 } = this;\r\n    shape1.setTransform(\r\n      shape1.x + this.vel1x * time,\r\n      shape1.y + this.vel1y * time,\r\n      1,\r\n      1,\r\n      shape1.rotation + this.rot1 * time,\r\n    );\r\n    shape2.setTransform(\r\n      shape2.x + this.vel2x * time,\r\n      shape2.y + this.vel2y * time,\r\n      1,\r\n      1,\r\n      shape2.rotation + this.rot2 * time,\r\n    );\r\n  }\r\n}\r\n","import { Graphics } from 'pixi.js';\r\n\r\nexport class SpaceshipView extends Graphics {\r\n  public constructor() {\r\n    super();\r\n    this.moveTo(10, 0).beginFill(0xffffff).lineTo(-7, 7).lineTo(-4, 0)\r\n      .lineTo(-7, -7)\r\n      .lineTo(10, 0)\r\n      .endFill();\r\n  }\r\n}\r\n","import { Graphics, Container, Text, TextStyle } from 'pixi.js';\r\n\r\nexport class DebugCrossView extends Container {\r\n\r\n    public constructor(size: number, text = '', color = 0xffffff, alpha = .2) {\r\n        super();\r\n        const thickness = 2;\r\n\r\n        const cross: Graphics = new Graphics();\r\n        cross.beginFill(color, alpha)\r\n            .drawRect(-size / 2, -thickness / 2, size, thickness)\r\n            .endFill();\r\n        cross.beginFill(color, alpha)\r\n            .drawRect(-thickness / 2, -size / 2, thickness, size)\r\n            .endFill();\r\n        this.addChild(cross);\r\n\r\n        if (text) {\r\n            const textStyle: TextStyle = new TextStyle({\r\n                fontFamily: 'Arial',\r\n                fontSize: 12,\r\n                fill: 0xffffff,\r\n            });\r\n          \r\n            const label: Text = new Text(text, textStyle);\r\n            label.setTransform(-label.width / 2, -label.height / 2);\r\n            this.addChild(label);\r\n        }\r\n    }\r\n}\r\n","export const NUMBER_0 = 48;\r\nexport const NUMBER_1 = 49;\r\nexport const NUMBER_2 = 50;\r\nexport const NUMBER_3 = 51;\r\nexport const NUMBER_4 = 52;\r\nexport const NUMBER_5 = 53;\r\nexport const NUMBER_6 = 54;\r\nexport const NUMBER_7 = 55;\r\nexport const NUMBER_8 = 56;\r\nexport const NUMBER_9 = 57;\r\nexport const A = 65;\r\nexport const B = 66;\r\nexport const C = 67;\r\nexport const D = 68;\r\nexport const E = 69;\r\nexport const F = 70;\r\nexport const G = 71;\r\nexport const H = 72;\r\nexport const I = 73;\r\nexport const J = 74;\r\nexport const K = 75;\r\nexport const L = 76;\r\nexport const M = 77;\r\nexport const N = 78;\r\nexport const O = 79;\r\nexport const P = 80;\r\nexport const Q = 81;\r\nexport const R = 82;\r\nexport const S = 83;\r\nexport const T = 84;\r\nexport const U = 85;\r\nexport const V = 86;\r\nexport const W = 87;\r\nexport const X = 88;\r\nexport const Y = 89;\r\nexport const Z = 90;\r\nexport const NUMPAD_0 = 96;\r\nexport const NUMPAD_1 = 97;\r\nexport const NUMPAD_2 = 98;\r\nexport const NUMPAD_3 = 99;\r\nexport const NUMPAD_4 = 100;\r\nexport const NUMPAD_5 = 101;\r\nexport const NUMPAD_6 = 102;\r\nexport const NUMPAD_7 = 103;\r\nexport const NUMPAD_8 = 104;\r\nexport const NUMPAD_9 = 105;\r\nexport const NUMPAD_MULTIPLY = 106;\r\nexport const NUMPAD_ADD = 107;\r\nexport const NUMPAD_ENTER = 108;\r\nexport const NUMPAD_SUBTRACT = 109;\r\nexport const NUMPAD_DECIMAL = 110;\r\nexport const NUMPAD_DIVIDE = 111;\r\nexport const F1 = 112;\r\nexport const F2 = 113;\r\nexport const F3 = 114;\r\nexport const F4 = 115;\r\nexport const F5 = 116;\r\nexport const F6 = 117;\r\nexport const F7 = 118;\r\nexport const F8 = 119;\r\nexport const F9 = 120;\r\nexport const F10 = 121; //  F10 is used by browser\r\nexport const F11 = 122;\r\nexport const F12 = 123;\r\nexport const F13 = 124;\r\nexport const F14 = 125;\r\nexport const F15 = 126;\r\nexport const BACKSPACE = 8;\r\nexport const TAB = 9;\r\nexport const ALTERNATE = 18;\r\nexport const ENTER = 13;\r\nexport const COMMAND = 15;\r\nexport const SHIFT = 16;\r\nexport const CONTROL = 17;\r\nexport const BREAK = 19;\r\nexport const CAPS_LOCK = 20;\r\nexport const NUMPAD = 21;\r\nexport const ESCAPE = 27;\r\nexport const SPACE = 32;\r\nexport const PAGE_UP = 33;\r\nexport const PAGE_DOWN = 34;\r\nexport const END = 35;\r\nexport const HOME = 36;\r\nexport const LEFT = 37;\r\nexport const RIGHT = 39;\r\nexport const UP = 38;\r\nexport const DOWN = 40;\r\nexport const INSERT = 45;\r\nexport const DELETE = 46;\r\nexport const NUMLOCK = 144;\r\nexport const SEMICOLON = 186;\r\nexport const EQUAL = 187;\r\nexport const COMMA = 188;\r\nexport const MINUS = 189;\r\nexport const PERIOD = 190;\r\nexport const SLASH = 191;\r\nexport const BACKQUOTE = 192;\r\nexport const LEFTBRACKET = 219;\r\nexport const BACKSLASH = 220;\r\nexport const RIGHTBRACKET = 221;\r\nexport const QUOTE = 222;\r\n","import { Engine, Entity, EntityStateMachine } from '@ash.ts/ash';\r\nimport { Container, DisplayObject } from '@pixi/display';\r\nimport {\r\n    Animation,\r\n    Asteroid,\r\n    Audio,\r\n    Bullet,\r\n    CameraShake,\r\n    Collision,\r\n    DeathThroes,\r\n    Display,\r\n    GameState,\r\n    Gun,\r\n    GunControls,\r\n    Motion,\r\n    MotionControls,\r\n    Position,\r\n    Spaceship,\r\n} from './components';\r\nimport { GameConfig } from './GameConfig';\r\nimport {\r\n    AsteroidDeathView,\r\n    AsteroidView,\r\n    BulletView,\r\n    DebugCrossView,\r\n    SpaceshipDeathView,\r\n    SpaceshipView,\r\n} from './graphics';\r\nimport * as Keyboard from './Keyboard';\r\n\r\nexport const entitiesNames = {\r\n    GAME: 'game',\r\n    CAMERA: 'camera',\r\n}\r\n\r\nexport class EntityCreator {\r\n    private waitEntity!: Entity;\r\n\r\n    private engine: Engine;\r\n\r\n    private config: GameConfig;\r\n\r\n    public constructor(engine: Engine, config: GameConfig) {\r\n        this.engine = engine;\r\n        this.config = config;\r\n    }\r\n\r\n    public destroyEntity(entity: Entity): void {\r\n        this.engine.removeEntity(entity);\r\n    }\r\n\r\n    public registerCameraContainer(container: Container): Entity {\r\n        const entity: Entity = new Entity(entitiesNames.CAMERA)\r\n            .add(new Display(container));\r\n        this.engine.addEntity(entity);\r\n        return entity;\r\n    }\r\n\r\n    public createGame(): Entity {\r\n        const gameEntity: Entity = new Entity(entitiesNames.GAME)\r\n            .add(new GameState())\r\n        this.engine.addEntity(gameEntity);\r\n        return gameEntity;\r\n    }\r\n\r\n    public createAsteroid(radius: number, x: number, y: number): Entity {\r\n        const asteroid: Entity = new Entity();\r\n\r\n        const fsm: EntityStateMachine = new EntityStateMachine(asteroid);\r\n\r\n        const velocityX = (Math.random() - 0.5) * 4 * (50 - radius);\r\n        const velocityY = (Math.random() - 0.5) * 4 * (50 - radius);\r\n        const angularVelocity: number = Math.random() * 2 - 1;\r\n\r\n        fsm.createState('alive')\r\n            .add(Motion)\r\n            .withInstance(new Motion(velocityX, velocityY, angularVelocity))\r\n            .add(Collision)\r\n            .withInstance(new Collision(radius))\r\n            .add(Display)\r\n            .withInstance(new Display(new AsteroidView(radius)));\r\n\r\n        const deathView: AsteroidDeathView = new AsteroidDeathView(radius);\r\n        fsm.createState('destroyed')\r\n            .add(Motion)\r\n            .withInstance(new Motion(velocityX, velocityY, 0))\r\n            .add(DeathThroes)\r\n            .withInstance(new DeathThroes(3))\r\n            .add(Display)\r\n            .withInstance(new Display(deathView))\r\n            .add(Animation)\r\n            .withInstance(new Animation(deathView));\r\n\r\n        asteroid\r\n            .add(new Asteroid(fsm))\r\n            .add(new Position(x, y, 0))\r\n            .add(new Audio());\r\n\r\n        fsm.changeState('alive');\r\n        this.engine.addEntity(asteroid);\r\n        return asteroid;\r\n    }\r\n\r\n    public createSpaceship(): Entity {\r\n        const spaceship: Entity = new Entity();\r\n        const fsm: EntityStateMachine = new EntityStateMachine(spaceship);\r\n\r\n        const motion: Motion = new Motion(0, 0, 0, 15);\r\n\r\n        fsm.createState('playing')\r\n            .add(Motion)\r\n            .withInstance(motion)\r\n            .add(MotionControls)\r\n            .withInstance(new MotionControls(Keyboard.LEFT, Keyboard.RIGHT, Keyboard.UP, 100, 3))\r\n            .add(Gun)\r\n            .withInstance(new Gun(8, 0, 0.3, 2))\r\n            .add(GunControls)\r\n            .withInstance(new GunControls(Keyboard.SPACE))\r\n            .add(Collision)\r\n            .withInstance(new Collision(9))\r\n            .add(Display)\r\n            .withInstance(new Display(new SpaceshipView()));\r\n\r\n        const deathView: SpaceshipDeathView = new SpaceshipDeathView();\r\n        fsm.createState('destroyed')\r\n            .add(Motion)\r\n            .withInstance(motion)\r\n            .add(DeathThroes)\r\n            .withInstance(new DeathThroes(5))\r\n            .add(Display)\r\n            .withInstance(new Display(deathView))\r\n            .add(Animation)\r\n            .withInstance(new Animation(deathView));\r\n\r\n        spaceship\r\n            .add(new Spaceship(fsm))\r\n            .add(new Position(this.config.width / 2, this.config.height / 2, 0))\r\n            .add(new Audio());\r\n\r\n        fsm.changeState('playing');\r\n        this.engine.addEntity(spaceship);\r\n        return spaceship;\r\n    }\r\n\r\n    public createUserBullet(gun: Gun, parentPosition: Position): Entity {\r\n        const cos: number = Math.cos(parentPosition.rotation);\r\n        const sin: number = Math.sin(parentPosition.rotation);\r\n        const bullet: Entity = new Entity()\r\n            .add(new Bullet())\r\n            .add(new DeathThroes(gun.bulletLifetime))\r\n            .add(new Position(\r\n                cos * gun.offsetFromParentX - sin * gun.offsetFromParentY + parentPosition.x,\r\n                sin * gun.offsetFromParentX + cos * gun.offsetFromParentY + parentPosition.y,\r\n                0,\r\n            ))\r\n            .add(new Collision(0))\r\n            .add(new Motion(cos * 150, sin * 150, 0, 0))\r\n            .add(new Display(new BulletView()));\r\n        this.engine.addEntity(bullet);\r\n        return bullet;\r\n    }\r\n\r\n    public createDebugCrossView(size: number, x: number, y: number): Entity {\r\n        const entity: Entity = new Entity()\r\n            .add(new Display(new DebugCrossView(size, `${x}:${y}`)))\r\n            .add(new Position(x, y));\r\n        this.engine.addEntity(entity);\r\n        return entity;\r\n    }\r\n\r\n    public cameraShake(magnitude = 16, time = 1): Entity | null {\r\n        const camera: Entity | null  = this.engine.getEntityByName(entitiesNames.CAMERA);\r\n        if (!camera) {\r\n            return null;\r\n        }\r\n\r\n        const entity: Entity = new Entity()\r\n            .add(new DeathThroes(1))\r\n            .add(new Animation(new CameraShake((camera.get(Display) as Display).displayObject, magnitude, time)));\r\n        this.engine.addEntity(entity);\r\n        return entity;\r\n    }\r\n}\r\n","export class GameConfig {\r\n\r\n    public static DEFAULT_LIVES_COUNT = 3;\r\n\r\n    public static DEFAULT_SCREEN_SIZE_AREA = 800 * 600;\r\n    public static DEFAULT_ASTEROIDS_MIN_COUNT = 2;\r\n    public static DEFAULT_ASTEROID_MAX_SIZE = 30;\r\n\r\n    public static DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_ASTEROID = GameConfig.DEFAULT_ASTEROID_MAX_SIZE / 8;\r\n    public static DEFAULT_CAMERA_SHAKE_TIME_FOR_ASTEROID = 2;\r\n\r\n    public static DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_SPACESHIP = GameConfig.DEFAULT_ASTEROID_MAX_SIZE / 4;\r\n    public static DEFAULT_CAMERA_SHAKE_TIME_FOR_SPACESHIP = 3;\r\n    \r\n    public static SCALE_SCREEN_TO_DEFAULT_SCREEN_SIZE_AREA = true;\r\n\r\n    public width: number;\r\n    public height: number;\r\n\r\n    public constructor(width: number, height: number) {\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n}\r\n","import asteroidSoundMp3 from './asteroid.mp3';\r\nimport asteroidSoundOgg from './asteroid.ogg';\r\nimport shootSoundMp3 from './shoot.mp3';\r\nimport shootSoundOgg from './shoot.ogg';\r\nimport shipSoundMp3 from './ship.mp3';\r\nimport shipSoundOgg from './ship.ogg';\r\n\r\nexport enum Sounds {\r\n  asteroid,\r\n  ship,\r\n  shoot,\r\n}\r\n\r\nconst sounds = [\r\n  {\r\n    key: Sounds.asteroid,\r\n    mp3: asteroidSoundMp3,\r\n    ogg: asteroidSoundOgg,\r\n  }, {\r\n    key: Sounds.shoot,\r\n    mp3: shootSoundMp3,\r\n    ogg: shootSoundOgg,\r\n  }, {\r\n    key: Sounds.ship,\r\n    mp3: shipSoundMp3,\r\n    ogg: shipSoundOgg,\r\n  },\r\n];\r\n\r\nfunction audioTypeDetect():'mp3' | 'ogg' | null {\r\n  const audio = document.createElement('audio');\r\n  const canPlayMp3 = audio.canPlayType('audio/mpeg');\r\n  const canPlayOgg = audio.canPlayType('audio/ogg');\r\n\r\n  let type:'mp3' | 'ogg' | null = null;\r\n\r\n  if (canPlayMp3 === 'probably') {\r\n    type = 'mp3';\r\n  } else if (canPlayOgg === 'probably') {\r\n    type = 'ogg';\r\n  } else if (canPlayMp3 === 'maybe') {\r\n    type = 'mp3';\r\n  } else if (canPlayOgg === 'maybe') {\r\n    type = 'ogg';\r\n  }\r\n\r\n  return type;\r\n}\r\n\r\nexport async function loadAudioDB(audioContext:AudioContext):Promise<Map<Sounds, AudioBuffer>> {\r\n  const audioDB = new Map<Sounds, AudioBuffer>();\r\n  const type = audioTypeDetect();\r\n\r\n  const loadSound = async (url:string, key:Sounds):Promise<any> => {\r\n    const response = await fetch(url);\r\n    const arrayBuffer = await response.arrayBuffer();\r\n    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\r\n    audioDB.set(key, audioBuffer);\r\n  };\r\n\r\n  if (type) {\r\n    await Promise.all(sounds.map((sound) => loadSound(sound[type!], sound.key)));\r\n  }\r\n\r\n  return audioDB;\r\n}\r\n","/* eslint-disable no-bitwise */\r\nconst WORD_SIZE = 32;\r\n\r\nexport class KeyPoll {\r\n  private keys:Int32Array = new Int32Array(4);\r\n\r\n  public constructor() {\r\n    window.addEventListener('keyup', this.keyUpHandler);\r\n    window.addEventListener('keydown', this.keyDownHandler);\r\n  }\r\n\r\n  public isDown(key:number):boolean {\r\n    const i = Math.floor(key / WORD_SIZE);\r\n    return (this.keys[i] & (1 << key - i * WORD_SIZE)) !== 0;\r\n  }\r\n\r\n  public isUp(key:number):boolean {\r\n    return !this.isDown(key);\r\n  }\r\n\r\n  private keyDownHandler = (event:KeyboardEvent):void => {\r\n    const { keyCode } = event;\r\n    const index = Math.floor(keyCode / WORD_SIZE);\r\n    this.keys[index] |= (1 << keyCode - index * WORD_SIZE);\r\n  };\r\n\r\n  private keyUpHandler = (event:KeyboardEvent):void => {\r\n    const { keyCode } = event;\r\n    const index = Math.floor(keyCode / WORD_SIZE);\r\n    this.keys[index] &= ~(1 << keyCode - index * WORD_SIZE);\r\n  };\r\n}\r\n","import { defineNode } from '@ash.ts/ash';\r\nimport {\r\n  Animation,\r\n  Asteroid,\r\n  Audio,\r\n  Bullet,\r\n  Collision,\r\n  DeathThroes,\r\n  Display,\r\n  GameState,\r\n  Gun,\r\n  GunControls,\r\n  Motion,\r\n  MotionControls,\r\n  Position,\r\n  Spaceship,\r\n  CameraShake,\r\n} from './components';\r\n\r\nexport const AnimationNode = defineNode({\r\n  animation: Animation,\r\n}, 'AnimationNode');\r\nexport type AnimationNode = InstanceType<typeof AnimationNode>;\r\n\r\nexport const AsteroidCollisionNode = defineNode({\r\n  asteroid: Asteroid,\r\n  position: Position,\r\n  collision: Collision,\r\n  audio: Audio,\r\n}, 'AsteroidCollisionNode');\r\nexport type AsteroidCollisionNode = InstanceType<typeof AsteroidCollisionNode>;\r\n\r\nexport const AudioNode = defineNode({\r\n  audio: Audio,\r\n}, 'AudioNode');\r\nexport type AudioNode = InstanceType<typeof AudioNode>;\r\n\r\nexport const BulletCollisionNode = defineNode({\r\n  bullet: Bullet,\r\n  position: Position,\r\n  collision: Collision,\r\n}, 'BulletCollisionNode');\r\nexport type BulletCollisionNode = InstanceType<typeof BulletCollisionNode>;\r\n\r\nexport const DeathThroesNode = defineNode({\r\n  death: DeathThroes,\r\n}, 'DeathThroesNode');\r\nexport type DeathThroesNode = InstanceType<typeof DeathThroesNode>;\r\n\r\nexport const GameNode = defineNode({\r\n  state: GameState,\r\n}, 'GameNode');\r\nexport type GameNode = InstanceType<typeof GameNode>;\r\n\r\nexport const GunControlNode = defineNode({\r\n  control: GunControls,\r\n  gun: Gun,\r\n  position: Position,\r\n  audio: Audio,\r\n}, 'GunControlNode');\r\nexport type GunControlNode = InstanceType<typeof GunControlNode>;\r\n\r\nexport const MotionControlNode = defineNode({\r\n  control: MotionControls,\r\n  position: Position,\r\n  motion: Motion,\r\n}, 'MotionControlNode');\r\nexport type MotionControlNode = InstanceType<typeof MotionControlNode>;\r\n\r\nexport const MovementNode = defineNode({\r\n  position: Position,\r\n  motion: Motion,\r\n  collision: Collision,\r\n}, 'MovementNode');\r\nexport type MovementNode = InstanceType<typeof MovementNode>;\r\n\r\nexport const RenderNode = defineNode({\r\n  position: Position,\r\n  display: Display,\r\n}, 'RenderNode');\r\nexport type RenderNode = InstanceType<typeof RenderNode>;\r\n\r\nexport const SpaceshipCollisionNode = defineNode({\r\n  spaceship: Spaceship,\r\n  position: Position,\r\n  collision: Collision,\r\n  audio: Audio,\r\n}, 'SpaceshipCollisionNode');\r\nexport type SpaceshipCollisionNode = InstanceType<typeof SpaceshipCollisionNode>;\r\n\r\nexport const SpaceshipNode = defineNode({\r\n  spaceship: Spaceship,\r\n  position: Position,\r\n}, 'SpaceshipNode');\r\nexport type SpaceshipNode = InstanceType<typeof SpaceshipNode>;\r\n\r\nexport const CameraShakeNode = defineNode({\r\n    shake: CameraShake,\r\n  }, 'CameraShakeNode');\r\n  export type CameraShakeNode = InstanceType<typeof CameraShakeNode>;","import { ListIteratingSystem } from '@ash.ts/ash';\r\nimport { AnimationNode } from '../nodes';\r\n\r\nexport class AnimationSystem extends ListIteratingSystem<AnimationNode> {\r\n  public constructor() {\r\n    super(AnimationNode);\r\n  }\r\n\r\n  public updateNode(node:AnimationNode, time:number):void {\r\n    node.animation.animation.animate(time);\r\n  }\r\n}\r\n","import { ListIteratingSystem } from '@ash.ts/ash';\r\nimport { AudioNode } from '../nodes';\r\nimport { Sounds } from '../sounds';\r\n\r\nexport class AudioSystem extends ListIteratingSystem<AudioNode> {\r\n  private audioContext:AudioContext;\r\n\r\n  private audioDB:Map<Sounds, AudioBuffer>;\r\n\r\n  public constructor(audioContext:AudioContext, audioDB:Map<Sounds, AudioBuffer>) {\r\n    super(AudioNode);\r\n    this.audioContext = audioContext;\r\n    this.audioDB = audioDB;\r\n  }\r\n\r\n  public updateNode(node:AudioNode, time:number):void {\r\n    for (const name of node.audio.toPlay) {\r\n      const sound = this.audioDB.get(name) || null;\r\n      const source = this.audioContext.createBufferSource();\r\n      source.buffer = sound;\r\n      source.connect(this.audioContext.destination);\r\n      source.start(0);\r\n    }\r\n    node.audio.toPlay.length = 0;\r\n  }\r\n}\r\n","import { Engine, NodeList, System } from '@ash.ts/ash';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport { GameConfig } from '../GameConfig';\r\nimport { AsteroidCollisionNode, BulletCollisionNode, GameNode, SpaceshipCollisionNode } from '../nodes';\r\nimport { Sounds } from '../sounds';\r\n\r\nexport class CollisionSystem extends System {\r\n    private creator: EntityCreator;\r\n\r\n    private games: NodeList<GameNode> | null = null;\r\n    private spaceships: NodeList<SpaceshipCollisionNode> | null = null;\r\n    private asteroids: NodeList<AsteroidCollisionNode> | null = null;\r\n    private bullets: NodeList<BulletCollisionNode> | null = null;\r\n\r\n    public constructor(creator: EntityCreator) {\r\n        super();\r\n        this.creator = creator;\r\n    }\r\n\r\n    public addToEngine(engine: Engine): void {\r\n        this.games = engine.getNodeList(GameNode);\r\n        this.spaceships = engine.getNodeList(SpaceshipCollisionNode);\r\n        this.asteroids = engine.getNodeList(AsteroidCollisionNode);\r\n        this.bullets = engine.getNodeList(BulletCollisionNode);\r\n    }\r\n\r\n    public update(time: number): void {\r\n        const maxSize = GameConfig.DEFAULT_ASTEROID_MAX_SIZE;\r\n        const minSize = Math.floor(maxSize * (1 / 3));\r\n        const oneSix = Math.floor(maxSize / 6);\r\n\r\n        for (let bullet = this.bullets!.head; bullet; bullet = bullet.next) {\r\n            for (let asteroid = this.asteroids!.head; asteroid; asteroid = asteroid.next) {\r\n                const distance = Math.hypot(asteroid.position.x - bullet.position.x, asteroid.position.y - bullet.position.y);\r\n                if (distance <= asteroid.collision.radius) {\r\n                    this.creator.destroyEntity(bullet.entity);\r\n                    if (asteroid.collision.radius > minSize) {\r\n                        const radius = asteroid.collision.radius - minSize;\r\n                        let x = asteroid.position.x + Math.random() * 10 - oneSix;\r\n                        let y = asteroid.position.y + Math.random() * 10 - oneSix;\r\n                        this.creator.createAsteroid(radius, x, y);\r\n                        x = asteroid.position.x + Math.random() * 10 - oneSix;\r\n                        y = asteroid.position.y + Math.random() * 10 - oneSix;\r\n                        this.creator.createAsteroid(radius, x, y);\r\n                    }\r\n                    asteroid.asteroid.fsm.changeState('destroyed');\r\n                    asteroid.audio.play(Sounds.asteroid);\r\n                    if (this.games!.head) {\r\n                        this.games!.head.state.hits += 1;\r\n                    }\r\n\r\n                    const scale = asteroid.collision.radius / GameConfig.DEFAULT_ASTEROID_MAX_SIZE;\r\n                    const magnitude = GameConfig.DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_ASTEROID * scale;\r\n                    this.creator.cameraShake(Math.floor(magnitude), GameConfig.DEFAULT_CAMERA_SHAKE_TIME_FOR_ASTEROID * scale);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let spaceship = this.spaceships!.head; spaceship; spaceship = spaceship.next) {\r\n            for (let asteroid = this.asteroids!.head; asteroid; asteroid = asteroid.next) {\r\n                const distance = Math.hypot(\r\n                    asteroid.position.x - spaceship.position.x,\r\n                    asteroid.position.y - spaceship.position.y,\r\n                );\r\n                if (distance <= asteroid.collision.radius + spaceship.collision.radius) {\r\n                    spaceship.spaceship.fsm.changeState('destroyed');\r\n                    spaceship.audio.play(Sounds.ship);\r\n                    if (this.games!.head) {\r\n                        this.games!.head.state.lives -= 1;\r\n                    }\r\n                    this.creator.cameraShake(GameConfig.DEFAULT_CAMERA_SHAKE_MAGNITUDE_FOR_SPACESHIP, GameConfig.DEFAULT_CAMERA_SHAKE_TIME_FOR_SPACESHIP);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public removeFromEngine(engine: Engine): void {\r\n        this.games = null;\r\n        this.spaceships = null;\r\n        this.asteroids = null;\r\n        this.bullets = null;\r\n    }\r\n}\r\n","import { ListIteratingSystem } from '@ash.ts/ash';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport { DeathThroesNode } from '../nodes';\r\n\r\nexport class DeathThroesSystem extends ListIteratingSystem<DeathThroesNode> {\r\n  private creator:EntityCreator;\r\n\r\n  public constructor(creator:EntityCreator) {\r\n    super(DeathThroesNode);\r\n    this.creator = creator;\r\n  }\r\n\r\n  public updateNode(node:DeathThroesNode, time:number):void {\r\n    node.death.countdown -= time;\r\n    if (node.death.countdown <= 0) {\r\n      this.creator.destroyEntity(node.entity);\r\n    }\r\n  }\r\n}\r\n","import { Engine, NodeList, System } from '@ash.ts/ash';\r\nimport { GameState } from '../components';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport { GameConfig } from '../GameConfig';\r\nimport { AsteroidCollisionNode, BulletCollisionNode, GameNode, SpaceshipNode } from '../nodes';\r\n\r\nexport class GameManager extends System {\r\n    private config: GameConfig;\r\n    private creator: EntityCreator;\r\n\r\n    private games: NodeList<GameNode> | null = null;\r\n    private spaceships: NodeList<SpaceshipNode> | null = null;\r\n    private asteroids: NodeList<AsteroidCollisionNode> | null = null;\r\n    private bullets: NodeList<BulletCollisionNode> | null = null;\r\n\r\n    private currentGameState = '';\r\n\r\n    public constructor(creator: EntityCreator, config: GameConfig) {\r\n        super();\r\n        this.creator = creator;\r\n        this.config = config;\r\n    }\r\n\r\n    public addToEngine(engine: Engine): void {\r\n        this.games = engine.getNodeList(GameNode);\r\n        this.spaceships = engine.getNodeList(SpaceshipNode);\r\n        this.asteroids = engine.getNodeList(AsteroidCollisionNode);\r\n        this.bullets = engine.getNodeList(BulletCollisionNode);\r\n    }\r\n\r\n    public removeFromEngine(engine: Engine): void {\r\n        this.games = null;\r\n        this.spaceships = null;\r\n        this.asteroids = null;\r\n        this.bullets = null;\r\n    }\r\n\r\n    public update(time: number): void {\r\n        const gameNode = this.games!.head;\r\n        if (!gameNode) {\r\n            return;\r\n        }\r\n\r\n        if (gameNode.state.state != GameState.PLAY) {\r\n            this.currentGameState = gameNode.state.state;\r\n            return;\r\n        }\r\n\r\n        if (this.currentGameState == GameState.WAIT_FOR_START || this.currentGameState == GameState.FINISH) {\r\n            // start\r\n            while (this.asteroids?.head) {\r\n                this.creator.destroyEntity(this.asteroids.head.entity);\r\n            }\r\n        }\r\n\r\n        this.currentGameState = gameNode.state.state;\r\n\r\n        if (this.spaceships!.empty) {\r\n            if (gameNode.state.lives) {\r\n                // next live\r\n                const positionX = this.config.width / 2;\r\n                const positionY = this.config.height / 2;\r\n                const deltaRadius = Math.floor(GameConfig.DEFAULT_ASTEROID_MAX_SIZE * 1.7);\r\n                let clearToAddSpaceship = true;\r\n                for (let asteroid = this.asteroids!.head; asteroid; asteroid = asteroid.next) {\r\n                    const distance = Math.hypot(asteroid.position.x - positionX, asteroid.position.y - positionY);\r\n                    if (distance <= asteroid.collision.radius + deltaRadius) {\r\n                        clearToAddSpaceship = false;\r\n                        break;\r\n                    }\r\n                }\r\n                if (clearToAddSpaceship) {\r\n                    this.creator.createSpaceship();\r\n                }\r\n            } else {\r\n                // finish\r\n                gameNode.state.setForFinish();\r\n            }\r\n        }\r\n\r\n        if (this.asteroids!.empty && this.bullets!.empty && this.spaceships!.head) {\r\n            // next level\r\n            const spaceship: SpaceshipNode | null = this.spaceships!.head;\r\n            gameNode.state.level += 1;\r\n            const asteroidCount: number = GameConfig.DEFAULT_ASTEROIDS_MIN_COUNT + gameNode.state.level;\r\n            const minDistance = Math.floor(GameConfig.DEFAULT_ASTEROID_MAX_SIZE * 2.7);\r\n            for (let i = 0; i < asteroidCount; i += 1) {\r\n                let positionX: number;\r\n                let positionY: number;\r\n                // check not on top of spaceship\r\n                do {\r\n                    positionX = Math.random() * this.config.width;\r\n                    positionY = Math.random() * this.config.height;\r\n                }\r\n                while (Math.hypot(positionX - spaceship.position.x, positionY - spaceship.position.y) <= minDistance);\r\n                this.creator.createAsteroid(GameConfig.DEFAULT_ASTEROID_MAX_SIZE, positionX, positionY);\r\n            }\r\n        }\r\n    }\r\n}","import { Engine, NodeList, System } from '@ash.ts/ash';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport { KeyPoll } from '../KeyPoll';\r\nimport { GameNode, GunControlNode } from '../nodes';\r\nimport { Sounds } from '../sounds';\r\nimport { TouchPoll } from '../TouchPoll';\r\n\r\nexport class GunControlSystem extends System {\r\n    \r\n    private readonly keyPoll: KeyPoll;\r\n    private readonly touchPoll: TouchPoll;\r\n    private readonly creator: EntityCreator;\r\n\r\n    private guns: NodeList<GunControlNode> | null = null;\r\n    private game: NodeList<GameNode> | null = null;\r\n\r\n    public constructor(keyPoll: KeyPoll, touchPoll: TouchPoll, creator: EntityCreator) {\r\n        super();\r\n        this.keyPoll = keyPoll;\r\n        this.touchPoll = touchPoll;\r\n        this.creator = creator;\r\n    }\r\n\r\n    addToEngine(engine: Engine): void {\r\n        this.guns = engine.getNodeList(GunControlNode);\r\n        this.game = engine.getNodeList(GameNode);\r\n    }\r\n\r\n    removeFromEngine(engine: Engine): void {\r\n        this.guns = null;\r\n        this.game = null;\r\n    }\r\n\r\n    update(time: number): void {\r\n        for (let node: GunControlNode | undefined | null = this.guns?.head; node; node = node?.next) {\r\n            const { control } = node;\r\n            const { position } = node;\r\n            const { gun } = node;\r\n\r\n            gun.shooting = this.keyPoll.isDown(control.trigger) || this.touchPoll.click;\r\n            gun.timeSinceLastShot += time;\r\n            if (gun.shooting && gun.timeSinceLastShot >= gun.minimumShotInterval) {\r\n                if (this.game && this.game.head) {\r\n                    this.game.head.state.shots++\r\n                }\r\n                this.creator.createUserBullet(gun, position);\r\n                node.audio.play(Sounds.shoot);\r\n                gun.timeSinceLastShot = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import Vue from \"vue\";\nimport Vuex, { Store } from \"vuex\";\n\nVue.use(Vuex);\n\nexport default new Store({});","export enum SystemPriorities {\r\n  preUpdate = 1,\r\n  update = 2,\r\n  move = 3,\r\n  resolveCollisions = 4,\r\n  animate = 5,\r\n  render = 6,\r\n  audio = 7,\r\n}\r\n","import { GameState } from \"@/game/components\";\r\nimport { createModule } from \"vuexok\";\r\nimport store from \"./index\";\r\n\r\nexport default createModule(store, \"storeGameModule\", {\r\n    namespaced: true,\r\n    state: {\r\n        state: GameState.WAIT_FOR_START,\r\n        \r\n        score: 0,\r\n        lives: 0,\r\n        level: 0,\r\n        hits: 0,\r\n        shots: 0,\r\n    },\r\n    mutations: {\r\n        reset(state) {\r\n            state.state = GameState.WAIT_FOR_START;\r\n            state.score = 0;\r\n            state.lives = 0;\r\n            state.level = 0;\r\n        },\r\n        setState(state, value: string) {\r\n            state.state = value;\r\n        },\r\n        setScore(state, value: number) {\r\n            state.score = value;\r\n        },\r\n        setLives(state, value: number) {\r\n            state.lives = value;\r\n        },\r\n        setLevel(state, value: number) {\r\n            state.level = value;\r\n        },\r\n        setHits(state, value: number) {\r\n            state.hits = value;\r\n        },\r\n        setShots(state, value: number) {\r\n            state.shots = value;\r\n        }\r\n\r\n    },\r\n    getters: {\r\n        level(state) {\r\n            const { level } = state;\r\n            return level;\r\n        },\r\n        state(storeState) {\r\n            const { state } = storeState;\r\n            return state;\r\n        },\r\n        score(state) {\r\n            const { score } = state;\r\n            return score;\r\n        },\r\n        lives(state) {\r\n            const { lives } = state;\r\n            return lives;\r\n        }\r\n        ,\r\n        hits(state) {\r\n            const { hits } = state;\r\n            return hits;\r\n        },\r\n        shots(state) {\r\n            const { shots } = state;\r\n            return shots;\r\n        }\r\n    }\r\n});\r\n","import storeGameModule from '@/vuex/storeGameModule';\r\nimport { Engine, NodeList, System } from '@ash.ts/ash';\r\nimport { GameState } from '../components';\r\nimport { GameNode } from '../nodes';\r\n\r\nexport class HudSystem extends System {\r\n    \r\n    private game: NodeList<GameNode> | null = null;\r\n    private gameState: GameState = new GameState();\r\n    \r\n    addToEngine(engine: Engine): void {\r\n        this.game = engine.getNodeList(GameNode);\r\n    }\r\n    removeFromEngine(engine: Engine): void {\r\n        this.game = null;\r\n    }\r\n    update(time: number): void {\r\n        const state: GameState | null | undefined = this.game?.head?.state;\r\n        if (!state) {\r\n            return;\r\n        }\r\n\r\n        if (storeGameModule.getters.state != this.gameState.state) {\r\n            if (\r\n                (this.gameState.state == GameState.WAIT_FOR_START || this.gameState.state == GameState.FINISH)\r\n                && storeGameModule.getters.state == GameState.PLAY\r\n            ) {\r\n                this.gameState.setForStart();\r\n                state.setForStart();\r\n            } else if (storeGameModule.getters.state == GameState.FINISH) {\r\n                this.gameState.setForFinish();\r\n                state.setForFinish();\r\n            } else {\r\n                this.gameState.state = storeGameModule.getters.state;\r\n                state.state = this.gameState.state;\r\n            }\r\n        } else {\r\n            if (state.state != this.gameState.state) {\r\n                this.gameState.state = state.state;\r\n                storeGameModule.mutations.setState(state.state);\r\n            }\r\n    \r\n            storeGameModule.mutations.setLives(state.lives);\r\n            storeGameModule.mutations.setLevel(state.level);\r\n            storeGameModule.mutations.setShots(state.shots);\r\n            storeGameModule.mutations.setHits(state.hits);\r\n        }\r\n\r\n        this.gameState.update(state);\r\n    }\r\n}\r\n","import { ListIteratingSystem } from '@ash.ts/ash';\r\nimport { KeyPoll } from '../KeyPoll';\r\nimport { MotionControlNode } from '../nodes';\r\nimport { TouchPoll } from '../TouchPoll';\r\n\r\nexport class MotionControlSystem extends ListIteratingSystem<MotionControlNode> {\r\n    private keyPoll: KeyPoll;\r\n    private touchPoll: TouchPoll;\r\n\r\n    public constructor(keyPoll: KeyPoll, touchPoll: TouchPoll) {\r\n        super(MotionControlNode);\r\n        this.keyPoll = keyPoll;\r\n        this.touchPoll = touchPoll;\r\n    }\r\n\r\n    public updateNode(node: MotionControlNode, time: number): void {\r\n        const { control } = node;\r\n        const { position } = node;\r\n        const { motion } = node;\r\n\r\n        if (this.keyPoll.isDown(control.left) || this.touchPoll.left) {\r\n            position.rotation -= control.rotationRate * time;\r\n            motion.velocityX += Math.cos(position.rotation) * control.accelerationRate / 2 * time;\r\n            motion.velocityY += Math.sin(position.rotation) * control.accelerationRate / 2 * time;\r\n        }\r\n\r\n        if (this.keyPoll.isDown(control.right) || this.touchPoll.right) {\r\n            position.rotation += control.rotationRate * time;\r\n            motion.velocityX += Math.cos(position.rotation) * control.accelerationRate / 2 * time;\r\n            motion.velocityY += Math.sin(position.rotation) * control.accelerationRate / 2 * time;\r\n        }\r\n\r\n        if (this.keyPoll.isDown(control.accelerate) || this.touchPoll.top) {\r\n            motion.velocityX += Math.cos(position.rotation) * control.accelerationRate * time;\r\n            motion.velocityY += Math.sin(position.rotation) * control.accelerationRate * time;\r\n        }\r\n    }\r\n}\r\n","import { ListIteratingSystem } from '@ash.ts/ash';\r\nimport { Bullet } from '../components';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport { GameConfig } from '../GameConfig';\r\nimport { MovementNode } from '../nodes';\r\n\r\nexport class MovementSystem extends ListIteratingSystem<MovementNode> {\r\n    private readonly config: GameConfig;\r\n    private readonly creator: EntityCreator;\r\n\r\n    public constructor(creator: EntityCreator, config: GameConfig) {\r\n        super(MovementNode);\r\n        this.creator = creator;\r\n        this.config = config;\r\n    }\r\n\r\n    public updateNode(node: MovementNode, time: number): void {\r\n        const deltaBounds = node.collision.radius;\r\n        const { position, motion } = node;\r\n        const { width, height } = this.config;\r\n        position.x += motion.velocityX * time;\r\n        position.y += motion.velocityY * time;\r\n\r\n        let transfer = false;\r\n        if (position.x < -deltaBounds) {\r\n            position.x += width + deltaBounds * 2;\r\n            transfer = true;\r\n        }\r\n        if (position.x > width + deltaBounds) {\r\n            position.x -= (width + deltaBounds * 2);\r\n            transfer = true;\r\n        }\r\n        if (position.y < -deltaBounds) {\r\n            position.y += height + deltaBounds * 2;\r\n            transfer = true;\r\n        }\r\n        if (position.y > height + deltaBounds) {\r\n            position.y -= (height + deltaBounds * 2);\r\n            transfer = true;\r\n        }\r\n\r\n        if (transfer && node.entity.get(Bullet)) {\r\n            this.creator.destroyEntity(node.entity);\r\n            return;\r\n        }\r\n\r\n        position.rotation += motion.angularVelocity * time;\r\n        if (motion.damping > 0) {\r\n            const xDamp: number = Math.abs(Math.cos(position.rotation) * motion.damping * time);\r\n            const yDamp: number = Math.abs(Math.sin(position.rotation) * motion.damping * time);\r\n            if (motion.velocityX > xDamp) {\r\n                motion.velocityX -= xDamp;\r\n            } else if (motion.velocityX < -xDamp) {\r\n                motion.velocityX += xDamp;\r\n            } else {\r\n                motion.velocityX = 0;\r\n            }\r\n            if (motion.velocityY > yDamp) {\r\n                motion.velocityY -= yDamp;\r\n            } else if (motion.velocityY < -yDamp) {\r\n                motion.velocityY += yDamp;\r\n            } else {\r\n                motion.velocityY = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { createModule } from \"vuexok\";\r\nimport store from \"./index\";\r\n\r\nexport default createModule(store, \"storeDevelopingModule\", {\r\n    namespaced: true,\r\n    state: {\r\n        displayRatio: 1,\r\n        deviceSize: '800x600',\r\n        sceneSize: '800x600',\r\n        scale: 1,\r\n    },\r\n    mutations: {\r\n        reset(state) {\r\n            state.displayRatio = 1;\r\n            state.deviceSize = '';\r\n            state.sceneSize = '';\r\n            state.scale = 1;\r\n        },\r\n        setDiplayRatio(state, value: number) {\r\n            state.displayRatio = value;\r\n        },\r\n        setScale(state, value: number) {\r\n            state.scale = value;\r\n        },\r\n        setDeviceSize(state, value: string) {\r\n            state.deviceSize = value;\r\n        },\r\n        setSceneSize(state, value: string) {\r\n            state.sceneSize = value;\r\n        },\r\n    },\r\n    getters: {\r\n        diplayRatio(state) {\r\n            const { displayRatio: diplayRatio } = state;\r\n            return diplayRatio;\r\n        },\r\n        scale(state) {\r\n            const { scale: scale } = state;\r\n            return scale;\r\n        },\r\n        deviceSize(state) {\r\n            const { deviceSize: deviceSize } = state;\r\n            return deviceSize;\r\n        },\r\n        sceneSize(state) {\r\n            const { sceneSize: sceneSize } = state;\r\n            return sceneSize;\r\n        },\r\n    }\r\n});\r\n","import { Application, Container, Renderer, AbstractRenderer } from 'pixi.js';\r\nimport { Engine, NodeList, System } from '@ash.ts/ash';\r\n\r\nimport { RenderNode, SpaceshipNode } from '../nodes';\r\nimport { GameConfig } from '../GameConfig';\r\nimport { EntityCreator } from '../EntityCreator';\r\nimport storeDevelopingModule from '@/vuex/storeDevelopingModule';\r\n\r\ninterface RenderSystemOptions {\r\n    emitStageEvents: boolean;\r\n}\r\n\r\nexport class RenderSystem extends System {\r\n    private resized = false;\r\n\r\n    private nodes: NodeList<RenderNode> | null = null;\r\n\r\n    private readonly renderer: Renderer | AbstractRenderer;\r\n    private readonly stage: Container;\r\n    private readonly view: HTMLCanvasElement;\r\n    private readonly entityCreator: EntityCreator;\r\n    private readonly gameConfig: GameConfig;\r\n\r\n    private container: HTMLElement;\r\n\r\n    private options: RenderSystemOptions;\r\n\r\n    private spaceship: NodeList<SpaceshipNode> | null = null;\r\n    \r\n    public constructor(container: HTMLElement, options: RenderSystemOptions = { emitStageEvents: true }, entityCreator: EntityCreator, gameConfig: GameConfig) {\r\n        super();\r\n\r\n        this.container = container;\r\n        this.options = options;\r\n        this.entityCreator = entityCreator;\r\n        this.gameConfig = gameConfig;\r\n\r\n        const app = new Application({\r\n            width: this.gameConfig.width,\r\n            height: this.gameConfig.height,\r\n            backgroundColor: 0,\r\n        });\r\n\r\n        this.renderer = app.renderer;\r\n        this.stage = app.stage;\r\n        this.view = app.view;\r\n\r\n        this.entityCreator.registerCameraContainer(this.stage);\r\n\r\n        this.resize();\r\n    }\r\n\r\n    public addToEngine(engine: Engine): void {\r\n        window.addEventListener('resize', this.handleWindowResize);\r\n\r\n        this.container.appendChild(this.view);\r\n        this.nodes = engine.getNodeList(RenderNode);\r\n        for (let node: RenderNode | null = this.nodes.head; node; node = node.next) {\r\n            this.addToDisplay(node);\r\n        }\r\n        this.nodes.nodeAdded.add(this.addToDisplay);\r\n        this.nodes.nodeRemoved.add(this.removeFromDisplay);\r\n\r\n        this.spaceship = engine.getNodeList(SpaceshipNode);\r\n    }\r\n\r\n    private addToDisplay = (node: RenderNode): void => {\r\n        const { displayObject } = node.display;\r\n        this.stage.addChild(displayObject);\r\n        if (this.options.emitStageEvents) {\r\n            displayObject.emit('addedToStage');\r\n        }\r\n    }\r\n\r\n    private handleWindowResize = (e: Event) => {\r\n        this.resized = true;\r\n    }\r\n\r\n    private removeFromDisplay = (node: RenderNode): void => {\r\n        const { displayObject } = node.display;\r\n        this.stage.removeChild(displayObject);\r\n        if (this.options.emitStageEvents) {\r\n            displayObject.emit('removedFromStage');\r\n        }\r\n    };\r\n\r\n    public update(time: number): void {\r\n        if (this.resized) {\r\n            this.resized = false;\r\n            this.resize();\r\n        }\r\n\r\n        for (let node = this.nodes!.head; node; node = node.next) {\r\n            const { display, position } = node;\r\n            display.displayObject.setTransform(position.x, position.y, 1, 1, position.rotation);\r\n        }\r\n        this.renderer.render(this.stage);\r\n    }\r\n\r\n    private resize(): void {\r\n        const rect: DOMRect = this.container.getBoundingClientRect();\r\n        const rectArea = rect.width * rect.height;\r\n        const scale = rectArea / GameConfig.DEFAULT_SCREEN_SIZE_AREA;\r\n\r\n        this.gameConfig.width = rect.width / scale;\r\n        this.gameConfig.height = rect.height / scale;\r\n\r\n        this.stage.scale.set(scale, scale);\r\n\r\n        this.renderer.view.style.width = rect.width + 'px';\r\n        this.renderer.view.style.height = rect.height + 'px';\r\n        this.renderer.resize(rect.width, rect.height);\r\n\r\n        storeDevelopingModule.mutations.setDeviceSize(`${window.innerWidth}, ${window.innerHeight}`);\r\n        storeDevelopingModule.mutations.setDiplayRatio(window.devicePixelRatio);\r\n        storeDevelopingModule.mutations.setSceneSize(`${rect.width}, ${rect.height}`);\r\n        storeDevelopingModule.mutations.setScale(scale);\r\n\r\n    }\r\n\r\n    public removeFromEngine(engine: Engine): void {\r\n        if (this.nodes) {\r\n            this.nodes.nodeAdded.remove(this.addToDisplay);\r\n            this.nodes.nodeRemoved.remove(this.removeFromDisplay);\r\n            this.nodes = null;\r\n        }\r\n\r\n        this.spaceship = null;\r\n\r\n        this.container.removeChild(this.view);\r\n    }\r\n}\r\n","export class TouchPoll {\r\n\r\n    private mouseDown = false;\r\n    private mouseDownX = 0;\r\n    private mouseDownY = 0;\r\n    private mouseDownTimestamp = 0;\r\n    private mouseDownRadius = 20;\r\n\r\n    private mouseMoveX = 0;\r\n    private mouseMoveY = 0;\r\n    \r\n    private clickTimeout = 200;\r\n\r\n    private distance = 0;\r\n\r\n    private mouseLeft = false;\r\n    private mouseRight = false;\r\n    private mouseTop = false;\r\n    private mouseBottom = false;\r\n    \r\n\r\n    public constructor() {\r\n        window.addEventListener('mousedown', this.handleMouseDown);\r\n        window.addEventListener('mouseup', this.handleMouseUp);\r\n        window.addEventListener('mousemove', this.handleMouseMove);\r\n\r\n        document.body.addEventListener('touchstart', this.handleTouchStart);\r\n        document.body.addEventListener('touchend', this.handleTouchEnd);\r\n        document.body.addEventListener('touchmove', this.handleTouchMove);\r\n    }\r\n\r\n    private handleTouchStart = (event: TouchEvent) => {\r\n        console.log('handleTouchStart', event, event.touches)\r\n        // event.preventDefault();\r\n\r\n        for (let i = 0; i < event.touches.length; i++) {\r\n         console.log(i, (event.touches[i] as Touch).target)\r\n        //  console.log(i, (event.touches[i] as Touch).)\r\n            break;\r\n        }\r\n\r\n        for (let i = 0; i < event.touches.length; i++) {\r\n            this.mouseDown = true;\r\n            this.mouseDownX = (event.touches[i] as Touch).clientX;\r\n            this.mouseDownY = (event.touches[i] as Touch).clientY;\r\n            this.mouseDownTimestamp = Date.now();\r\n            break;\r\n        }\r\n    }\r\n\r\n    private handleTouchEnd = (event: TouchEvent) => {\r\n        // event.preventDefault();\r\n        this.handleTouchMove(event);\r\n        this.mouseDown = false;\r\n        this.resetDirections();\r\n    }\r\n\r\n    private handleTouchMove = (event: TouchEvent) => {\r\n        // event.preventDefault();\r\n        if (this.mouseDown) {\r\n            for (let i = 0; i < event.touches.length; i++) {\r\n                this.mouseMoveX = event.touches[0].clientX;\r\n                this.mouseMoveY = event.touches[0].clientY;\r\n                this.distance = this.getDistance(this.mouseDownX, this.mouseDownY, this.mouseMoveX, this.mouseMoveY);\r\n                if (this.distance > this.mouseDownRadius) {\r\n                    if (this.mouseDownY - this.mouseMoveY > this.mouseDownRadius) {\r\n                        this.mouseTop = true;\r\n                    } else if (this.mouseDownX - this.mouseMoveX > this.mouseDownRadius ) {\r\n                        this.mouseLeft = true;\r\n                    } else if (this.mouseMoveX - this.mouseDownX > this.mouseDownRadius) {\r\n                        this.mouseRight = true;\r\n                    } else {\r\n                        this.mouseBottom = true;\r\n                    }\r\n                } else {\r\n                    this.resetDirections();\r\n                }\r\n                break;\r\n            }\r\n            \r\n        }\r\n    }\r\n\r\n    private handleMouseDown = (event: MouseEvent) => {\r\n        // event.preventDefault();\r\n        this.mouseDown = true;\r\n        this.mouseDownX = event.clientX;\r\n        this.mouseDownY = event.clientY;\r\n        this.mouseDownTimestamp = Date.now();\r\n    }\r\n\r\n    private handleMouseUp = (event: MouseEvent) => {\r\n        // event.preventDefault();\r\n        this.handleMouseMove(event);\r\n        this.mouseDown = false;\r\n        this.resetDirections();\r\n    }\r\n\r\n    private handleMouseMove = (event: MouseEvent) => {\r\n        // event.preventDefault();\r\n        if (this.mouseDown) {\r\n            this.mouseMoveX = event.clientX;\r\n            this.mouseMoveY = event.clientY;\r\n            this.distance = this.getDistance(this.mouseDownX, this.mouseDownY, this.mouseMoveX, this.mouseMoveY);\r\n            if (this.distance > this.mouseDownRadius) {\r\n                if (this.mouseDownY - this.mouseMoveY > this.mouseDownRadius) {\r\n                    this.mouseTop = true;\r\n                } else if (this.mouseDownX - this.mouseMoveX > this.mouseDownRadius ) {\r\n                    this.mouseLeft = true;\r\n                } else if (this.mouseMoveX - this.mouseDownX > this.mouseDownRadius) {\r\n                    this.mouseRight = true;\r\n                } else {\r\n                    this.mouseBottom = true;\r\n                }\r\n            } else {\r\n                this.resetDirections();\r\n            }\r\n        }\r\n    }\r\n\r\n    private getDistance(x1: number, y1: number, x2: number, y2: number): number {\r\n        const a = x1 - x2;\r\n        const b = y1 - y2;\r\n        return Math.sqrt( a * a + b * b );\r\n    }\r\n\r\n    private resetDirections(): void {\r\n        this.mouseLeft = false;\r\n        this.mouseRight = false;\r\n        this.mouseTop = false;\r\n        this.mouseBottom = false;\r\n    }\r\n\r\n    get left(): boolean {\r\n        return this.mouseLeft;\r\n    }\r\n    get right(): boolean {\r\n        return this.mouseRight;\r\n    }\r\n    get top(): boolean {\r\n        return this.mouseTop;\r\n    }\r\n    get down(): boolean {\r\n        return this.mouseBottom;\r\n    }\r\n    get click(): boolean {\r\n        return !this.mouseDown \r\n            && Date.now() - this.mouseDownTimestamp <= this.clickTimeout \r\n            && this.distance < this.mouseDownRadius\r\n        ;\r\n    }\r\n}","import { Engine, FrameTickProvider } from '@ash.ts/ash';\r\nimport { EntityCreator } from './EntityCreator';\r\nimport { GameConfig } from './GameConfig';\r\nimport { KeyPoll } from './KeyPoll';\r\nimport {\r\n  AnimationSystem,\r\n  AudioSystem,\r\n  CollisionSystem,\r\n  DeathThroesSystem,\r\n  GameManager,\r\n  GunControlSystem,\r\n  HudSystem,\r\n  MotionControlSystem,\r\n  MovementSystem,\r\n  RenderSystem,\r\n  SystemPriorities,\r\n} from './systems';\r\nimport { loadAudioDB } from './sounds';\r\nimport { TouchPoll } from './TouchPoll';\r\n\r\nexport async function asteroids(container:HTMLElement):Promise<void> {\r\n  const config = new GameConfig(container.clientWidth, container.clientHeight);\r\n  const engine = new Engine();\r\n  const creator = new EntityCreator(engine, config);\r\n  const keyPoll = new KeyPoll();\r\n  const touchPoll = new TouchPoll();\r\n  const tickProvider = new FrameTickProvider();\r\n\r\n  const audioContext = new AudioContext();\r\n  const audioDB = await loadAudioDB(audioContext);\r\n\r\n  tickProvider.add((delta:number) => engine.update(delta));\r\n  tickProvider.start();\r\n\r\n  engine.addSystem(new GameManager(creator, config), SystemPriorities.preUpdate);\r\n  engine.addSystem(new MotionControlSystem(keyPoll, touchPoll), SystemPriorities.update);\r\n  engine.addSystem(new GunControlSystem(keyPoll, touchPoll, creator), SystemPriorities.update);\r\n  engine.addSystem(new DeathThroesSystem(creator), SystemPriorities.update);\r\n  engine.addSystem(new MovementSystem(creator, config), SystemPriorities.move);\r\n  engine.addSystem(new CollisionSystem(creator), SystemPriorities.resolveCollisions);\r\n  engine.addSystem(new AnimationSystem(), SystemPriorities.animate);\r\n  engine.addSystem(new HudSystem(), SystemPriorities.preUpdate);\r\n  engine.addSystem(new RenderSystem(container, {emitStageEvents: true},  creator, config), SystemPriorities.render);\r\n//   engine.addSystem(new AudioSystem(audioContext, audioDB), SystemPriorities.audio);\r\n\r\n  creator.createGame();\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from 'vue-property-decorator';\r\nimport { asteroids } from '@/game/Asteroids';\r\nimport storeGameModule from '@/vuex/storeGameModule';\r\nimport { GameState } from '@/game/components';\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class Game extends Vue {\r\n    mounted() {\r\n        storeGameModule.mutations.reset();\r\n        setTimeout(() => {\r\n            asteroids(this.$refs.game as HTMLElement);\r\n        }, 100);\r\n    }\r\n\r\n    destroyed() {\r\n        console.log('Game', 'destroyed')\r\n    }\r\n\r\n    private get start(): boolean {\r\n        return storeGameModule.getters.state == GameState.WAIT_FOR_START;\r\n    }\r\n\r\n    private get finish(): boolean {\r\n        return storeGameModule.getters.state == GameState.FINISH;\r\n    }\r\n\r\n    private get precision(): string {\r\n        const result = Math.floor((storeGameModule.getters.hits / storeGameModule.getters.shots) * 100);\r\n        return result ? `${result}%` : '';\r\n    }\r\n\r\n    private handleClick(): void {\r\n        if (\r\n            storeGameModule.getters.state == GameState.WAIT_FOR_START\r\n            || storeGameModule.getters.state == GameState.FINISH\r\n        ) {\r\n            storeGameModule.mutations.setState(GameState.PLAY);\r\n        }\r\n    }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Game.vue?vue&type=template&id=783a7232&scoped=true&\"\nimport script from \"./Game.vue?vue&type=script&lang=ts&\"\nexport * from \"./Game.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Game.vue?vue&type=style&index=0&id=783a7232&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"783a7232\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport \"@/styles/assets.styl\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport Game from \"./vue/Game.vue\";\n\n@Component({\n    components: {\n        Game\n    },\n})\nexport default class App extends Vue {\n    mounted() {\n        console.log(\"App mounted\");\n    }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=bd1513aa&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","declare const vkBridge: any;\r\ndeclare const VK: any;\r\n\r\ninterface VKBridgeResponce {\r\n    type: string;\r\n    data: {[key: string]: any};\r\n}\r\n\r\nexport default class VKBridge {\r\n\r\n    private viewportWidth = 0;\r\n\r\n    constructor() {\r\n        Promise.all([this.setupBridge(), this.setupVK()])\r\n            .then(() => {\r\n                this.setupIFrame();\r\n            })\r\n            .catch((error) => {\r\n                const err = error;\r\n            })\r\n    }\r\n\r\n    private handleBridgeSubscribe(e: VKBridgeResponce): void {\r\n        console.log(\"vkBridge event\", e)\r\n        switch (e.type) {\r\n            case 'VKWebAppUpdateConfig':\r\n                console.log('e.data.viewport_width, e.data.viewport_height', e.data.viewport_width, e.data.viewport_height);\r\n                this.viewportWidth = e.data.viewport_width;\r\n            break;\r\n            case 'VKWebAppResizeWindowResult':\r\n                console.log('VKWebAppResizeWindowResult', e.data.width, e.data.height);\r\n            break;\r\n        }\r\n    }\r\n\r\n    private handleOnScrollTop(vkScrollPos: number, vkHeight: number, vkOffset: number): void {\r\n        console.log('handleOnScrollTop', vkHeight)\r\n        // vkBridge.send(\"VKWebAppResizeWindow\", {\"width\": this.viewportWidth, \"height\": vkHeight - 50});\r\n    }\r\n\r\n    private setupBridge(): Promise<any> {\r\n        return new Promise((resolve, reject) => {\r\n            const unsubscribe = () => {\r\n                vkBridge.unsubscribe(unsubscribe);\r\n                resolve(true);\r\n            };\r\n\r\n            vkBridge.subscribe(unsubscribe);\r\n            vkBridge.subscribe((e: any) => {this.handleBridgeSubscribe(e);});\r\n            vkBridge.send(\"VKWebAppInit\", {});\r\n        });\r\n    }\r\n\r\n    private setupVK(): Promise<any> {\r\n        return new Promise((resolve, reject) => {\r\n            VK.init(\r\n                () => {resolve(true);},\r\n                () => {reject(false);},\r\n                '5.130'\r\n            );\r\n        });\r\n    }\r\n\r\n    private setupIFrame(): void {\r\n        VK.addCallback(\"onScrollTop\", (vkScrollPos: number, vkHeight: number, vkOffset: number) => {\r\n            this.handleOnScrollTop(vkScrollPos, vkHeight, vkOffset);\r\n        });\r\n        VK.callMethod(\"scrollTop\");\r\n    }\r\n}","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport VKBridge from './vk/VKBridge';\r\nimport store from './vuex'\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  store,\r\n  render: h => h(App)\r\n}).$mount('#app');\r\n\r\nnew VKBridge();\r\n","module.exports = __webpack_public_path__ + \"media/ship.fc37c3a9.mp3\";"],"sourceRoot":""}